<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>{%block title%}{%endblock%}</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
    
  <link href="{{ url_for('static', filename = '/img/favicon.png') }}" rel="icon">
  <link href="{{ url_for('static', filename = '/img/apple-touch-icon.png') }}" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Poppins:300,300i,400,400i,600,600i,700,700i|Satisfy|Comic+Neue:300,300i,400,400i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->

  <link href="{{ url_for('static', filename = '/vendor/animate.css/animate.min.css') }}" rel="stylesheet">
  <link href="{{ url_for('static', filename = '/vendor/bootstrap/css/bootstrap.min.css') }}" rel="stylesheet">
  <link href="{{ url_for('static', filename = '/vendor/bootstrap-icons/bootstrap-icons.css') }}" rel="stylesheet">
  <link href="{{ url_for('static', filename = '/vendor/boxicons/css/boxicons.min.css') }}" rel="stylesheet">
  <link href="{{ url_for('static', filename = '/vendor/glightbox/css/glightbox.min.css') }}" rel="stylesheet">
  <link href="{{ url_for('static', filename = '/vendor/swiper/swiper-bundle.min.css') }}" rel="stylesheet">
  <link href="{{ url_for('static', filename='/vendor/datatables/datatables.min.css') }}" rel="stylesheet">
  <!-- Template Main CSS File -->
  <link href="{{ url_for('static', filename = '/css/style.css') }}" rel="stylesheet">

  <style>
    @media (max-width: 767px) {
    .carousel-inner .carousel-item > div {
        display: none;
    }
    .carousel-inner .carousel-item > div:first-child {
        display: block;
    }
}

.carousel-inner .carousel-item.active,
.carousel-inner .carousel-item-next,
.carousel-inner .carousel-item-prev {
    display: flex;
}

/* medium and up screens */
@media (min-width: 768px) {
    
    .carousel-inner .carousel-item-end.active,
    .carousel-inner .carousel-item-next {
      transform: translateX(25%);
    }
    
    .carousel-inner .carousel-item-start.active, 
    .carousel-inner .carousel-item-prev {
      transform: translateX(-25%);
    }
}

.carousel-inner .carousel-item-end,
.carousel-inner .carousel-item-start { 
  transform: translateX(0);
}

  </style>

  {% block cssperfile %}

  {%endblock%}

      <!-- <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script> -->
    <!-- <link
      href="https://fonts.googleapis.com/css?family=Roboto:400,500"
      rel="stylesheet"
    /> -->

    <!-- <link rel="stylesheet" type="text/css" href="./style.css" /> -->
    <!-- <script src="{{ url_for('static', filename = '/js/maps.js') }}"></script> -->
  <!-- =======================================================
  * Template Name: Delicious - v4.4.0
  * Template URL: https://bootstrapmade.com/delicious-free-restaurant-bootstrap-theme/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>

  <!-- ======= Top Bar ======= -->
 
  <section id="topbar" class="d-flex align-items-center fixed-top">
    <div class="container-fluid container-xl d-flex align-items-center justify-content-center justify-content-lg-start">
       {% if current_user.is_authenticated %} 
        {% block h1PageTitle %} {% endblock %}
       {% else %}
      <i class="bi bi-phone d-flex align-items-center"><span>+63915-560-0480</span></i>
      <i class="bi bi-facebook ms-4 d-none d-lg-flex align-items-center"><span>facebook.com/abuelosdeli</span></i>
      <i class="bi bi-instagram ms-4 d-none d-lg-flex align-items-center"><span>instagram.com/abuelosdeli</span></i>

      {% endif %}
    </div>
  </section>

  <!-- ======= Header ======= -->
  <header id="header" class="fixed-top d-flex align-items-center {% if not current_user.is_authenticated and request.path != '/carts/view-cart'%} header-transparent {% endif %}">
    <div class="container-fluid container-xl d-flex align-items-center justify-content-between">

      <div class="logo me-auto">
        <h1><a href="index.html">Abuelo's Delicatessen</a></h1>
        <!-- Uncomment below if you prefer to use an image logo -->
        <!-- <a href="index.html"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>-->
      </div>

      <nav id="navbar" class="navbar order-last order-lg-0 mb-3">
        <ul>
          {% if current_user.is_authenticated %}
          <li><a class="nav-link scrollto" href="/dashboard">Home</a></li>
          <li class="dropdown"><a href="#"><span>Orders</span> <i class="bi bi-chevron-down"></i></a>
            <ul>
              <li><a class="nav-link scrollto" href="/orders">List of Orders</a></li>
              <li><a href="/orders/orders-fulfilled-canceled">Fulfilled / Canceled Orders</a></li>
            </ul>
          </li>
          <li class="dropdown"><a href="#"><span>Profile</span> <i class="bi bi-chevron-down"></i></a>
            <ul>
              <li><a href="#" data-bs-toggle="modal" data-bs-target="#changePassword">Change Password</a></li>
              <li><a href="/auth/logout">Logout</a></li>
            </ul>
          </li>
        </ul>

         {% elif request.path == '/carts/view-cart' %}
         <li><a class="nav-link scrollto" href="/">Home</a></li>
         <a class="nav-link" href="/carts/view-cart">Cart<i class="bi bi-cart"></i></a>
          {% else %}
          <li><a class="nav-link scrollto" href="/">Home</a></li>
          <li><a class="nav-link scrollto" href="#about">About</a></li>
          <li><a class="nav-link scrollto" href="#menu">Our Products</a></li>
          <!-- <li><a class="nav-link scrollto" href="#specials">Specials</a></li> -->

          <li><a class="nav-link scrollto" href="#gallery">Gallery</a></li>

          <li>
            <a class="nav-link" href="/carts/view-cart">Cart<i class="bi bi-cart"></i></a>
          </li>
          <li>
          </li>
        </ul>
 
      {%endif%}
      <i class="bi bi-list mobile-nav-toggle"></i>
    </nav>
    {% if not current_user.is_authenticated and request.path != '/carts/view-cart'%}
    <a href="#login" class="book-a-table-btn scrollto" data-bs-toggle="modal" data-bs-target="#loginModal">Login</a>
    {%endif%}
    </div>
  </header><!-- End Header -->

 {% if not current_user.is_authenticated and request.path != '/carts/view-cart'%} 
  <!-- ======= Hero Section ======= -->
  <section id="hero">
    <div class="hero-container">
      <div id="heroCarousel" data-bs-interval="5000" class="carousel slide carousel-fade" data-bs-ride="carousel">

        <ol class="carousel-indicators" id="hero-carousel-indicators"></ol>

        <div class="carousel-inner" role="listbox">

          <!-- Slide 1 -->
          <div class="carousel-item active" style="background: url({{url_for('static', filename = '/img/slide/slide-1.jpg')}});">
            <div class="carousel-container">
              <div class="carousel-content">
                <h2 class="animate__animated animate__fadeInDown">Abuelo's Delicatessen</h2>
                <p class="animate__animated animate__fadeInUp"></p>
                <div>
                  <a href="#menu" class="btn-menu animate__animated animate__fadeInUp scrollto">Our Products</a>
                </div>
              </div>
            </div>
          </div>

          <!-- Slide 2 -->
          <div class="carousel-item" style="background: url({{ url_for('static', filename = '/img/slide/slide-2.jpg' )}});">
            <div class="carousel-container">
              <div class="carousel-content">
                <h2 class="animate__animated animate__fadeInDown">Abuelo's Delicatessen</h2>
                <!-- <p class="animate__animated animate__fadeInUp">Ut velit est quam dolor ad a aliquid qui aliquid. Sequi ea ut et est quaerat sequi nihil ut aliquam. Occaecati alias dolorem mollitia ut. Similique ea voluptatem. Esse doloremque accusamus repellendus deleniti vel. Minus et tempore modi architecto.</p> -->
                <div>
                  <a href="#menu" class="btn-menu animate__animated animate__fadeInUp scrollto">Our Products</a>
                </div>
              </div>
            </div>
          </div>

          <!-- Slide 3 -->
          <div class="carousel-item" style="background:  url({{ url_for('static', filename = '/img/slide/slide-3.jpg' )}});">
            <div class="carousel-background">
              <img src="{{ url_for('static', filename = '/img/slide/slide-3.jpg' ) }}" alt=""></div>
            <div class="carousel-container">
              <div class="carousel-content">
                <h2 class="animate__animated animate__fadeInDown">Abuelo's Delicatessen</h2>
                <!-- <p class="animate__animated animate__fadeInUp">Ut velit est quam dolor ad a aliquid qui aliquid. Sequi ea ut et est quaerat sequi nihil ut aliquam. Occaecati alias dolorem mollitia ut. Similique ea voluptatem. Esse doloremque accusamus repellendus deleniti vel. Minus et tempore modi architecto.</p> -->
                <div>
                  <a href="#menu" class="btn-menu animate__animated animate__fadeInUp scrollto">Our Products</a>
                </div>
              </div>
            </div>
          </div>

        </div>

        <a class="carousel-control-prev" href="#heroCarousel" role="button" data-bs-slide="prev">
          <span class="carousel-control-prev-icon bi bi-chevron-left" aria-hidden="true"></span>
        </a>

        <a class="carousel-control-next" href="#heroCarousel" role="button" data-bs-slide="next">
          <span class="carousel-control-next-icon bi bi-chevron-right" aria-hidden="true"></span>
        </a>

      </div>
    </div>
  </section><!-- End Hero -->
{% endif %}
  {%block content%} {%endblock%}

  <!-- Modal -->
  <div class="modal fade" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" id="changePassword" aria-modal="true" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title">Change Password</h3>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <form class="needs-validation" novalidate method="POST" id="change_password_form">
          <div class="modal-body">
              <div class="form-group">
                <label for="current_password">Current Password</label>
                <input type="password" class="form-control" id="current_password" name="current_password" required>
                <div class="invalid-feedback">
                  Current password does not match!
                </div>

              </div>
              <div class="form-group">
                <label for="new_password">New Password</label>
                <input type="password" class="form-control" id="new_password" name="new_password">
              </div>
              <div class="form-group">
                <label for="login_password">Confirm Password</label>
                <input type="password" class="form-control" id="confirm_password" name="confirm_password">
              </div>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn book-a-table-btn">Submit</button>
          </div>
        </form>
      </div>
    </div>
  </div>
   <!-- Modal -->
   <!-- <div class="modal fade" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" id="viewProduct" aria-modal="true" role="dialog">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="modal-title">Order Detail</h3>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <form action="#" method="POST" id="order_detail_form">
          <div class="modal-body">
            <section class="inner-page">
              <div class="container">
                  <div class="row">
                    <div class="col-md">
                    <div class="table-responsive">
                      <table id="order_detail_table" class="table table-striped align-middle" style="width:100%">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Customer</th>
                                <th>Delivery Address</th>
                                <th>Email</th>
                                <th>Contact #</th>
                                <th>Order Status</th>
                                <th>Order Date</th>
                                <th>Controls</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                        </table>
                        </div>
                    </div>
                  </div>
              </div>
            </section>
          <div class="modal-footer">
            <button type="submit" class="btn book-a-table-btn" id="add_product_button">Add</button>
          </div>
        </form>
      </div>
    </div>
  </div> -->
  <!-- ======= Footer ======= -->
  <footer id="footer" class="mt-5">
    <div class="container">
      <h3>Abuelo's Delicatessen</h3>
      <!-- <p>Et aut eum quis fuga eos sunt ipsa nihil. Labore corporis magni eligendi fuga maxime saepe commodi placeat.</p> -->
      <div class="social-links">
        <!-- <a href="#" class="twitter"><i class="bx bxl-twitter"></i></a> -->
        <a href="facebook.com/abuelosdeli" class="facebook"><i class="bx bxl-facebook"></i></a>
        <a href="instagram.com/abuelosdeli" class="instagram"><i class="bx bxl-instagram"></i></a>
        <!-- <a href="#" class="google-plus"><i class="bx bxl-skype"></i></a>
        <a href="#" class="linkedin"><i class="bx bxl-linkedin"></i></a> -->
      </div>
      <div class="copyright">
        &copy; Copyright <strong><span>Abuelo's Delicatessen</span></strong>. All Rights Reserved
      </div>
      <div class="credits">
        <!-- All the links in the footer should remain intact. -->
        <!-- You can delete the links only if you purchased the pro version. -->
        <!-- Licensing information: https://bootstrapmade.com/license/ -->
        <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/delicious-free-restaurant-bootstrap-theme/ -->
        Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
      </div>
    </div>
  </footer><!-- End Footer -->

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
 
  <script src="{{ url_for('static', filename = '/vendor/bootstrap/js/bootstrap.bundle.min.js') }}"></script>
  <script src="{{ url_for('static', filename = '/vendor/glightbox/js/glightbox.min.js') }}"></script>
  <script src="{{ url_for('static', filename = '/vendor/isotope-layout/isotope.pkgd.min.js') }}"></script>
  <script src="{{ url_for('static', filename = '/vendor/php-email-form/validate.js') }}"></script>
  <script src="{{ url_for('static', filename = '/vendor/swiper/swiper-bundle.min.js') }}"></script>
  <script src="{{ url_for('static', filename='/vendor/datatables/datatables.min.js') }}"></script>
  <!-- Template Main JS File -->
  <script src="{{ url_for('static', filename = '/js/main.js') }}"></script>

  <!-- Sweetalert2 JS File -->
  <script src="{{ url_for('static', filename = '/js/sweetalert2.all.min.js') }}"></script>

  <!-- Custom Scripts -->
  <script type="text/javascript">
  const Toast = Swal.mixin({
    toast: true,
    position: 'top-start',
    showConfirmButton: false,
    timer: 4000,
    timerProgressBar: true,
    didOpen: (toast) => {
      toast.addEventListener('mouseenter', Swal.stopTimer)
      toast.addEventListener('mouseleave', Swal.resumeTimer)
    }
  })

var formElemCp = document.getElementById("change_password_form");

formElemCp.addEventListener("submit",(e)=>{
  e.preventDefault()
  let formdata = new FormData(formElemCp);

  const data = {}
  formdata.forEach((value, key) => (data[key] = value))

  let error_ctr = 0;
  var elementCp = formElemCp.elements;

    for (var i = 0, element; element = elementCp[i++];) {
        if (element.type === 'password' && element.value === ""){
          error_ctr++
        }
         
    }
    if (error_ctr > 0){
      Toast.fire({
        icon: 'error',
        title: 'Please fillout form properly!'
            })
            error_ctr = 0;
          }

    else{
      fetch('/auth/change-pass',{
      method: 'POST',
      body: JSON.stringify(data)
      })
    .then(response => {
      //console.log(response.json())
      if(response.status == '200'){
        Toast.fire({
        icon: 'success',
        title: 'Password changed successfully!'
            })

            error_ctr = 0;
            var myModalEl = document.getElementById('changePassword')
            var modal = bootstrap.Modal.getInstance(myModalEl)
            modal.hide()

            for (var i = 0, element; element = elementCp[i++];) {
              if (element.type === 'password'){
                element.value = "";
              }
              
    }
    
      }
      else if(response.status == '204'){
        Toast.fire({
        icon: 'error',
        title: 'Wrong current password!'
            })
            error_ctr = 0;
          }
      else if(response.status == '417'){
        Toast.fire({
        icon: 'error',
        title: 'Password must be at least 5 characters!'
            })
            error_ctr = 0;
      }else{
        Toast.fire({
        icon: 'error',
        title: 'New password and Confirm password does not match!'
            })
            error_ctr = 0;
      }
      // return response.json()

            })
      
 
    }


});
  </script>
{%block jsperfile%}{%endblock%}
</body>

</html>